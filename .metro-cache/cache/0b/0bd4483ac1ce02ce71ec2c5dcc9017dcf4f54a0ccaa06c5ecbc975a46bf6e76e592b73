{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":26,"index":175}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,d){\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return c}}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return h}});var o=r(d[0]),t=e(r(d[1])),n=e(r(d[2])),s=r(d[3]);const l=\"https://readhub-62.preview.emergentagent.com\",u=(0,o.createContext)(void 0),c=({children:e})=>{const[c,h]=(0,o.useState)(null),[f,A]=(0,o.useState)(null),[p,k]=(0,o.useState)(!0);(0,o.useEffect)(()=>{w()},[]);const w=async()=>{console.log('=== AUTH CHECK INITIATED ===');try{const e=await t.default.getItem('session_token');if(console.log('Stored token found:',e?'YES':'NO'),e){console.log('Setting token in state first...'),A(e),await new Promise(e=>setTimeout(e,100)),console.log('Fetching user data from /api/auth/me');const o=await n.default.get(`${l}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});console.log('User data received:',o.data),h(o.data),console.log('\\u2705 Auth check complete - user authenticated')}else console.log('No token found - user not authenticated')}catch(e){console.error('=== AUTH CHECK FAILED ==='),console.error('Error:',e),console.error('Response:',e.response?.data),await t.default.removeItem('session_token'),A(null),h(null)}finally{k(!1),console.log('=== AUTH CHECK FINISHED ===')}};return(0,s.jsx)(u.Provider,{value:{user:c,token:f,loading:p,login:async(e,o)=>{console.log('=== AUTH LOGIN ATTEMPT ==='),console.log('Email:',e),console.log('API URL:',l);try{const s=await n.default.post(`${l}/api/auth/login`,{email:e,password:o});console.log('Login response:',s.data);const{session_token:u,user:c}=s.data;if(!u||!c)throw console.error('Invalid response: missing session_token or user'),new Error('Invalid response from server');return console.log('Storing session_token in AsyncStorage...'),await t.default.setItem('session_token',u),console.log('Setting token and user in state...'),A(u),h(c),console.log('\\u2705 Login successful! User:',c),c}catch(e){throw console.error('=== LOGIN ERROR ==='),console.error('Error:',e),console.error('Response:',e.response?.data),e}},register:async(e,o,s)=>{const u=await n.default.post(`${l}/api/auth/register`,{email:e,name:o,password:s}),{session_token:c,user:f}=u.data;await t.default.setItem('session_token',c),A(c),h(f)},logout:async()=>{console.log('AuthContext: logout called');try{f&&(console.log('AuthContext: calling backend logout API'),await n.default.post(`${l}/api/auth/logout`,{},{headers:{Authorization:`Bearer ${f}`}}),console.log('AuthContext: backend logout successful'))}catch(e){console.log('Logout error:',e)}finally{console.log('AuthContext: clearing AsyncStorage'),await t.default.removeItem('session_token'),console.log('AuthContext: AsyncStorage cleared'),console.log('AuthContext: clearing user and token state'),h(null),A(null),console.log('AuthContext: logout complete, user and token set to null')}},checkAuth:w},children:e})},h=()=>{const e=(0,o.useContext)(u);if(!e)throw new Error('useAuth must be used within AuthProvider');return e}});","lineCount":1,"map":[[1,143,28,0,"Object"],[1,150,28,0,"defineProperty"],[1,165,28,0,"_e"],[1,168,28,0],[1,184,28,0,"enumerable"],[1,196,28,0],[1,198,28,0,"get"],[1,202,28,0],[1,220,28,0,"AuthProvider"],[1,221,28,0],[1,225,146,0,"Object"],[1,232,146,0,"defineProperty"],[1,247,146,0,"_e"],[1,250,146,0],[1,261,146,0,"enumerable"],[1,273,146,0],[1,275,146,0,"get"],[1,279,146,0],[1,297,146,0,"useAuth"],[1,298,146,0],[1,302,1,0],[1,306,1,0,"_react"],[1,308,1,0,"r"],[1,310,1,0,"d"],[1,312,1,0],[1,316,2,0,"AsyncStorage"],[1,318,2,0,"_interopDefault"],[1,320,2,0,"r"],[1,322,2,0,"d"],[1,324,2,0],[1,329,3,0,"axios"],[1,331,3,0,"_interopDefault"],[1,333,3,0,"r"],[1,335,3,0,"d"],[1,337,3,0],[1,342,3,26,"_reactJsxRuntime"],[1,344,3,26,"r"],[1,346,3,26,"d"],[1,348,3,26],[1,352,5,0],[1,358,5,6,"API_URL"],[1,360,5,13],[1,407,26,6,"AuthContext"],[1,410,26,20],[1,412,26,20,"createContext"],[1,414,26,33,"createContext"],[1,434,26,63,"undefined"],[1,437,28,13,"AuthProvider"],[1,439,28,69,"AuthProvider"],[1,441,28,72,"children"],[1,456,29,2],[1,462,29,9,"user"],[1,464,29,15,"setUser"],[1,468,29,26],[1,470,29,26,"useState"],[1,472,29,34,"useState"],[1,482,29,48],[1,489,30,9,"token"],[1,491,30,16,"setToken"],[1,495,30,28],[1,497,30,28,"useState"],[1,499,30,36,"useState"],[1,509,30,52],[1,516,31,9,"loading"],[1,518,31,18,"setLoading"],[1,522,31,32],[1,524,31,32,"useState"],[1,526,31,40,"useState"],[1,537,31,41],[1,541,33,2],[1,543,33,2,"useEffect"],[1,545,33,11,"useEffect"],[1,556,33,12],[1,561,34,4,"checkAuth"],[1,566,35,5],[1,570,37,2],[1,576,37,8,"checkAuth"],[1,578,37,20,"async"],[1,588,38,4,"console"],[1,596,38,12,"log"],[1,600,38,16],[1,632,39,4],[1,636,40,6],[1,642,40,12,"storedToken"],[1,650,40,32,"AsyncStorage"],[1,652,40,44,"default"],[1,660,40,45,"getItem"],[1,668,40,53],[1,685,43,6],[1,688,41,6,"console"],[1,696,41,14,"log"],[1,700,41,18],[1,722,41,41,"storedToken"],[1,724,41,55],[1,730,41,63],[1,736,43,10,"storedToken"],[1,738,43,23],[1,739,44,8,"console"],[1,747,44,16,"log"],[1,751,44,20],[1,786,45,8,"setToken"],[1,788,45,17,"storedToken"],[1,797,48,14],[1,801,48,18,"Promise"],[1,809,48,26,"resolve"],[1,812,48,37,"setTimeout"],[1,823,48,48,"resolve"],[1,825,48,57],[1,831,50,8,"console"],[1,839,50,16,"log"],[1,843,50,20],[1,883,51,8],[1,889,51,14,"response"],[1,897,51,31,"axios"],[1,899,51,36,"default"],[1,907,51,37,"get"],[1,911,51,41],[1,914,51,44,"API_URL"],[1,930,51,67],[1,931,52,10,"headers"],[1,939,52,19],[1,940,52,21,"Authorization"],[1,954,52,36],[1,964,52,46,"storedToken"],[1,971,54,8,"console"],[1,979,54,16,"log"],[1,983,54,20],[1,1005,54,43,"response"],[1,1007,54,52,"data"],[1,1013,55,8,"setUser"],[1,1015,55,16,"response"],[1,1017,55,25,"data"],[1,1023,56,8,"console"],[1,1031,56,16,"log"],[1,1035,56,20],[1,1085,57,6],[1,1091,58,8,"console"],[1,1099,58,16,"log"],[1,1103,58,20],[1,1145,60,4],[1,1146,60,6],[1,1152,60,13,"error"],[1,1155,61,6,"console"],[1,1163,61,14,"error"],[1,1169,61,20],[1,1198,62,6,"console"],[1,1206,62,14,"error"],[1,1212,62,20],[1,1221,62,30,"error"],[1,1224,63,6,"console"],[1,1232,63,14,"error"],[1,1238,63,20],[1,1250,63,33,"error"],[1,1252,63,39,"response"],[1,1262,63,49,"data"],[1,1274,64,12,"AsyncStorage"],[1,1276,64,24,"default"],[1,1284,64,25,"removeItem"],[1,1295,64,36],[1,1312,65,6,"setToken"],[1,1314,65,15],[1,1320,66,6,"setUser"],[1,1322,66,14],[1,1327,67,4],[1,1328,67,5],[1,1336,68,6,"setLoading"],[1,1339,68,17],[1,1342,69,6,"console"],[1,1350,69,14,"log"],[1,1354,69,18],[1,1384,70,4],[1,1387,139,2],[1,1394,140,4],[1,1396,140,4,"_reactJsxRuntime"],[1,1398,140,4,"jsx"],[1,1403,140,5,"AuthContext"],[1,1405,140,17,"Provider"],[1,1414,140,25],[1,1415,140,26,"value"],[1,1421,140,33],[1,1422,140,35,"user"],[1,1429,140,41,"token"],[1,1437,140,48,"loading"],[1,1447,140,57,"login"],[1,1453,73,16,"async"],[1,1459,73,23,"email"],[1,1461,73,38,"password"],[1,1466,74,4,"console"],[1,1474,74,12,"log"],[1,1478,74,16],[1,1508,75,4,"console"],[1,1516,75,12,"log"],[1,1520,75,16],[1,1529,75,26,"email"],[1,1532,76,4,"console"],[1,1540,76,12,"log"],[1,1544,76,16],[1,1555,76,28,"API_URL"],[1,1558,78,4],[1,1562,79,6],[1,1568,79,12,"response"],[1,1576,79,29,"axios"],[1,1578,79,34,"default"],[1,1586,79,35,"post"],[1,1591,79,40],[1,1594,79,43,"API_URL"],[1,1613,79,69],[1,1614,79,71,"email"],[1,1622,79,78,"password"],[1,1635,80,6,"console"],[1,1643,80,14,"log"],[1,1647,80,18],[1,1665,80,37,"response"],[1,1667,80,46,"data"],[1,1673,82,6],[1,1679,82,12,"session_token"],[1,1693,82,14,"session_token"],[1,1695,82,29,"user"],[1,1700,82,35,"userData"],[1,1703,82,48,"response"],[1,1705,82,57,"data"],[1,1710,84,6],[1,1714,84,11,"session_token"],[1,1718,84,29,"userData"],[1,1720,86,8],[1,1726,85,8,"console"],[1,1734,85,16,"error"],[1,1740,85,22],[1,1791,86,14],[1,1795,86,18,"Error"],[1,1801,86,24],[1,1833,95,6],[1,1840,89,6,"console"],[1,1848,89,14,"log"],[1,1852,89,18],[1,1902,90,12,"AsyncStorage"],[1,1904,90,24,"default"],[1,1912,90,25,"setItem"],[1,1920,90,33],[1,1936,90,50,"session_token"],[1,1939,91,6,"console"],[1,1947,91,14,"log"],[1,1951,91,18],[1,1989,92,6,"setToken"],[1,1991,92,15,"session_token"],[1,1994,93,6,"setUser"],[1,1996,93,14,"userData"],[1,1999,94,6,"console"],[1,2007,94,14,"log"],[1,2011,94,18],[1,2044,94,47,"userData"],[1,2047,95,13,"userData"],[1,2048,96,4],[1,2049,96,6],[1,2055,96,13,"error"],[1,2058,100,6],[1,2064,97,6,"console"],[1,2072,97,14,"error"],[1,2078,97,20],[1,2101,98,6,"console"],[1,2109,98,14,"error"],[1,2115,98,20],[1,2124,98,30,"error"],[1,2127,99,6,"console"],[1,2135,99,14,"error"],[1,2141,99,20],[1,2153,99,33,"error"],[1,2155,99,39,"response"],[1,2165,99,49,"data"],[1,2171,100,12,"error"],[1,2172,101,4],[1,2175,140,64,"register"],[1,2184,104,19,"async"],[1,2190,104,26,"email"],[1,2192,104,41,"name"],[1,2194,104,55,"password"],[1,2199,105,4],[1,2205,105,10,"response"],[1,2213,105,27,"axios"],[1,2215,105,32,"default"],[1,2223,105,33,"post"],[1,2228,105,38],[1,2231,105,41,"API_URL"],[1,2253,105,70],[1,2254,105,72,"email"],[1,2262,105,79,"name"],[1,2269,105,85,"password"],[1,2283,106,10,"session_token"],[1,2297,106,12,"session_token"],[1,2299,106,27,"user"],[1,2304,106,33,"userData"],[1,2307,106,46,"response"],[1,2309,106,55,"data"],[1,2320,107,10,"AsyncStorage"],[1,2322,107,22,"default"],[1,2330,107,23,"setItem"],[1,2338,107,31],[1,2354,107,48,"session_token"],[1,2357,108,4,"setToken"],[1,2359,108,13,"session_token"],[1,2362,109,4,"setUser"],[1,2364,109,12,"userData"],[1,2368,140,74,"logout"],[1,2375,112,17,"async"],[1,2385,113,4,"console"],[1,2393,113,12,"log"],[1,2397,113,16],[1,2427,114,4],[1,2431,115,10,"token"],[1,2435,116,8,"console"],[1,2443,116,16,"log"],[1,2447,116,20],[1,2496,117,14,"axios"],[1,2498,117,19,"default"],[1,2506,117,20,"post"],[1,2511,117,25],[1,2514,117,28,"API_URL"],[1,2534,117,55],[1,2535,117,56],[1,2537,117,59],[1,2538,118,10,"headers"],[1,2546,118,19],[1,2547,118,21,"Authorization"],[1,2561,118,36],[1,2571,118,46,"token"],[1,2578,120,8,"console"],[1,2586,120,16,"log"],[1,2590,120,20],[1,2632,122,4],[1,2633,122,6],[1,2639,122,13,"error"],[1,2642,123,6,"console"],[1,2650,123,14,"log"],[1,2654,123,18],[1,2670,123,35,"error"],[1,2672,124,4],[1,2673,124,5],[1,2681,126,6,"console"],[1,2689,126,14,"log"],[1,2693,126,18],[1,2737,127,12,"AsyncStorage"],[1,2739,127,24,"default"],[1,2747,127,25,"removeItem"],[1,2758,127,36],[1,2775,128,6,"console"],[1,2783,128,14,"log"],[1,2787,128,18],[1,2824,131,6,"console"],[1,2832,131,14,"log"],[1,2836,131,18],[1,2882,132,6,"setUser"],[1,2884,132,14],[1,2890,133,6,"setToken"],[1,2892,133,15],[1,2898,134,6,"console"],[1,2906,134,14,"log"],[1,2910,134,18],[1,2969,136,4],[1,2972,140,82,"checkAuth"],[1,2985,140,94,"children"],[1,2994,141,7,"children"],[1,2999,146,13,"useAuth"],[1,3001,146,23,"useAuth"],[1,3006,147,2],[1,3012,147,8,"context"],[1,3015,147,18],[1,3017,147,18,"useContext"],[1,3019,147,28,"useContext"],[1,3031,147,29,"AuthContext"],[1,3034,148,2],[1,3038,148,7,"context"],[1,3040,149,4],[1,3046,149,10],[1,3050,149,14,"Error"],[1,3056,149,20],[1,3100,151,2],[1,3107,151,9,"context"],[1,3109,152,2],[1,3112]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkAuth","Promise$argument_0","login","register","logout","useAuth"],"mappings":"AAA;qEC2B;YCK;GDE;oBEE;0BCW,mCD;GFuB;gBIE;GJ6B;mBKE;GLM;iBME;GNyB;CDO;uBQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}